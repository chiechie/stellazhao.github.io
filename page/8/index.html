<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"chiechie.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="a reader &amp; thinker">
<meta property="og:type" content="website">
<meta property="og:title" content="Chiechie&#39;s Mini World">
<meta property="og:url" content="https://chiechie.github.io/page/8/index.html">
<meta property="og:site_name" content="Chiechie&#39;s Mini World">
<meta property="og:description" content="a reader &amp; thinker">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Chiechie">
<meta property="article:tag" content="博客, AI, 互联网">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://chiechie.github.io/page/8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Chiechie's Mini World</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Chiechie's Mini World" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Chiechie's Mini World</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Set your course by the stars, not by the lights of passing ships. —— Omar Bradley</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chiechie.github.io/2021/07/08/data_structure/ds0_summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chiechie">
      <meta itemprop="description" content="a reader & thinker">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chiechie's Mini World">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/08/data_structure/ds0_summary/" class="post-title-link" itemprop="url">数据结构0 总览</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-08 09:17:29" itemprop="dateCreated datePublished" datetime="2021-07-08T09:17:29+08:00">2021-07-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-09 13:37:50" itemprop="dateModified" datetime="2021-07-09T13:37:50+08:00">2021-07-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>数据结构是在计算机中存储数据的方法</p>
<p>一般情况下，精心挑选的数据结构能产生有效的算法</p>
</blockquote>
<h2 id="why-数据结构">why 数据结构？</h2>
<ol type="1">
<li>数据结构是对数据的一种组织形式，以方便后续数据被高效地使用。</li>
<li>数据结构是创建快速高效算法的必要ingredeints，数据结构可以帮助管理和组织数据；让代码看起来更干净。</li>
<li>数据结构/抽象数据类/程序的关系就好像，使用乐高搭建一个建筑，层层抽象。</li>
</ol>
<h3 id="抽象数据类型和数据结构">抽象数据类型和数据结构</h3>
<ol start="2" type="1">
<li>抽象数据类型(Abstract Data Type, ADT)是对数据结构的一个抽象，它只提供接口（interface），数据结构必须遵循该接口（interface），但是这个接口不涉及任何关于实施或者编程语言相关的细节。</li>
<li>抽象数据类型的数据结构的关系，举个例子，从一个地方A到另一个地方B有很多种方法，可以骑自行车或者走路或者坐火车，前者是抽象数据类型，后者是该抽象数据类型对应的具体的数据结构。</li>
<li>一个抽象数据类型之定义了数据结构应该实现什么功能，应该有哪些方法，至于方法的实现细节抽象数据类型是不管的。</li>
<li>举几个抽象数据类型和数据结构的例子
<ul>
<li>抽象数据类型列表（list）可以使用动态数组或者链表实现，这两个数据结构都能实现add，removing，indexing元素。</li>
<li>抽象数据类型队列（Queue）可以使用Linked list based Queue/Array based Queue/Stack based Queue。</li>
<li>抽象数据类型（Map）可以使用Tree Map/Hash Map/Hash Table实现</li>
</ul></li>
<li>ADT is a logical description and data structure is concrete.</li>
<li>ADT is the logical picture of the data and the operations to manipulate the component elements of the data.</li>
<li>Data structure is the actual representation of the data during the implementation and the algorithms to manipulate the data elements.</li>
<li>ADT is in the logical level and data structure is in the implementation level.</li>
</ol>
<h3 id="计算复杂度分析">计算复杂度分析</h3>
<ol type="1">
<li><p>为了分析我们的数据结构的性能：执行该算法需要花费多少时间和占用多少内存？</p></li>
<li><p>O(*)表示在worst case的情况下，一个算法复杂度上界是多少，当输入数据变得很大的时候，有助于评估性能, 一般来说有这么几种时间复杂度:</p>
<ul>
<li>常数时间: O(1)</li>
<li>对数时间： O(log(n))</li>
<li>线性时间： O(n)</li>
<li>linearithmix时间: O(nlog(n))</li>
<li>二次时间： O(n^2)</li>
<li>三次时间: O(n^3)</li>
<li>指数时间：O（b^n）</li>
<li>因子时间: O(n!)</li>
</ul>
<p>n表示输入的大小复杂度从低到高。</p></li>
<li><p>因为O（*）只关注当数据变得足够大的时候，算法的表现，所以算法的实际运行时间中的常数项，低阶项都可以省掉，系数都可以扔掉哦。 <span class="math inline">\(O(n + c) = O(n)\)</span> <span class="math inline">\(O(cn ) = O(n)\)</span> <span class="math inline">\(O(n^2 +2*n) = O(n^2)\)</span></p></li>
<li><p>二分查找是用在一个有序数组上的查找算法，时间复杂度是对数</p></li>
<li><p>找一个集合的所有子集-时间复杂度是指数O(2^n)</p></li>
<li><p>找一个字符串的所有排列O(n!)</p></li>
<li><p>使用合并排序算法来排序，时间复杂度是 O(nlogn)</p></li>
</ol>
<h2 id="数据结构有哪几种">数据结构有哪几种？</h2>
<ol type="1">
<li><p>数据结构分为线性数据结构和非线性数据结构</p></li>
<li><p>线性数据结构包括数组（array），链表（linked list），栈（stack），队列（queue） <img src="b3728c27302a8548fe9e8a87e619ca83.png" alt="线性数据结构" /></p></li>
<li><p>非线性数据结构包括树和图,树可以认为是有向图的special case <img src="e6d5a8d9a75587abe612dfef9abffc01.png" alt="非线性数据结构" /></p></li>
<li><p>图分有向图和无向图 <img src="18c651092d22c7204021d10a5a79b0ff.png" alt="有向图vs无向图" /></p></li>
<li><p>无向图的一个实例是fb的社交网络，边表示好友关系。 <img src="f3fc896014d62fb1ec1c96c93210f7ff.png" alt="社交网络" /></p></li>
<li><p>基于社交网络这个数据结构有什么应用呢？好友推荐, 推荐朋友的朋友,网络社会科学的小世界</p>
<blockquote>
<p>小世界网络的重要性质：“流行病学”、“合作”、“知识”</p>
</blockquote></li>
<li><p>有向图的一个实例是万维网： <img src="b9b97250ce6e998045dcbb0d5b379724.png" alt="www" /></p></li>
<li><p>图还可以分有权图和无权图。无权图可认为是权图的special case，权重都为1。</p></li>
<li><p>有权图的一个实例是高速公路网,边代表距离 <img src="5b81b50b2d2b048ed3188b71af85a02f.png" alt="公路网" /></p></li>
<li><p>树的一个实例是家谱，树种，任意一对节点，有且只有一条通路（不存在loop嘛）</p></li>
<li><p>因果图是一个有向有权图。</p></li>
</ol>
<h2 id="参考">参考</h2>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://github.com/williamfiset/Algorithms">algorithm-github</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=gXgEDyodOJU">youtube</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=V_TulH374hw">Graph-theoretic Models</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/13965757/what-is-the-difference-between-an-abstract-data-typeadt-and-a-data-structure">the difference-between-ADT和DS</a></li>
<li><a target="_blank" rel="noopener" href="https://www.csie.ntu.edu.tw/~htlin/course/dsa21spring/">数据结构和算法</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=RBSGKlAvoiM&amp;t=102s">Data Structures Easy to Advanced Course</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chiechie.github.io/2021/07/07/reading_notes/AFML/AFML3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chiechie">
      <meta itemprop="description" content="a reader & thinker">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chiechie's Mini World">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/07/reading_notes/AFML/AFML3/" class="post-title-link" itemprop="url">《Advances in Financial Machine Learning》读书笔记3 回测</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-07 11:08:30" itemprop="dateCreated datePublished" datetime="2021-07-07T11:08:30+08:00">2021-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-29 20:08:37" itemprop="dateModified" datetime="2021-07-29T20:08:37+08:00">2021-07-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%98%85%E8%AF%BB/" itemprop="url" rel="index"><span itemprop="name">阅读</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="chapter-10-仓位大小">chapter 10 仓位大小</h2>
<blockquote>
<p>即使股价预测很准，但是仓位配置的不当，还是会亏钱。</p>
</blockquote>
<ol type="1">
<li><p>假定三期股价为 [1, 0.5, 1.25]，仓位1: [0.5, 1, 0] &amp; 仓位2: [1, 0.5, 0]，则前者挣钱而后者亏钱。这种情况下，更偏好这样的下注策略：建仓时保留一些现金，如果交易信号加强（股价变为0.5），就追加投资。</p></li>
<li><p>下图是交易信号(z)和最佳下注大小(m)之间的函数关系：</p>
<p>横轴的z表示交易信号强弱，纵轴m代表最佳下注大小：<span class="math inline">\(m = x (2Z [z] − 1), m\in{[-1,1]}\)</span></p>
<p>交易信号z是模型预测结果x的函数，预测结果x越极端，则分母越小，分子绝对值越大， z越接近<span class="math inline">\(+\infty\)</span>或者<span class="math inline">\(-\infty\)</span>，则交易信号越强, 但是可以看到仓位超过一定范围就饱和了。</p>
<p>总的来说，交易信号越强，下注越大，但是，当交易信号强度超过一定值，就可以不用加仓，最佳持仓水平m可以保持不变，这一点跟直觉是稳和的，价格猛涨多了一段时间之后，再往上走就很难了，这个时候不能追高。</p>
<figure>
<img src="./image-20210711134750210.png" alt="image-20210711134750210" /><figcaption aria-hidden="true">image-20210711134750210</figcaption>
</figure></li>
<li><p>如果每次预测时，如果交易信号的微小改变就要调仓，那换手率就太高了，作者建议可以对预测结果做滑动平均，或者将下注量离散化（如下图）<img src="./image-20210711140908880.png" alt="image-20210711140908880" /></p></li>
<li><p>动态BET SIZES 和 限价：当股票的市场价格<span class="math inline">\(p_t\)</span>和预测价格<span class="math inline">\(f_t\)</span>波动时，可用如下方法动态地确定下注量<span class="math inline">\(\hat{q}_{i, t}\)</span>： <span class="math display">\[\hat{q}_{i, t}=\operatorname{int}\left[\frac{x}{\sqrt{w+x^{2}}} \cdot Q\right]\]</span> <span class="math inline">\(x=f_{i}-p_{t}\)</span>为预测价与当前价的差价，如果x绝对值大于0，说明当前市场出现了套利空间，绝对值越大，越要押注，</p></li>
</ol>
<p>Q为最大持仓量, <em>𝜔</em>是一个用来控制sigmoid的宽度的系数， <em>𝜔</em>越小，策略就越保守。</p>
<h2 id="chapter-11-回测有风险">chapter 11 回测有风险</h2>
<p>回测是量化中最重要但也最容易被误用的工具，本章将介绍回测时容易犯的错误。</p>
<ol type="1">
<li>一个物理实验室可以通过控制变量来探究精确的因果关系，而回测不是实验，它并不能证明一个策略好，只能证明一个策略不好。</li>
<li>要做好回测极其困难，我们至少会面临这些问题:
<ul>
<li>幸存者偏差：只用现存的股票构建投资组合回测，殊不知过去多少公司倒闭退市了；</li>
<li>Look-ahead bias：回测时用到的数据在那一刻还没发布；</li>
<li>事后诸葛亮（各种事后分析都在编故事）；</li>
<li>手续费：要模拟手续费很难，唯一准确的方式是上实盘；</li>
<li>空头：实际交易中如何找借方、空头的成本、空头的额度都需要考虑；</li>
</ul></li>
<li>即使避免了以上问题，你的回测也可能是错的——在一个数据集上回测了成百上千次才得到的漂亮结果，大概率是假的。如第八章所述，特征重要性分析帮助我们理解 ML 发现的结果，它在回测之前进行，是一种“事前“归因。相反，回测并不能帮我们理解为什么一个策略会盈利。通过回测发现的有效“因子”如同上一期彩票的中奖号码，对下一轮抽奖无益。回测前做好数据结构化、标签、加权比回测本身更重要。</li>
<li>重复回测带来的过拟合可以认为是一种选择偏差，要避免这种偏差可能是量化中最根本的问题。</li>
<li>以下步骤可以帮我们减少这种偏差:
<ul>
<li>在多种金融资产上回测：由于金融资产的多样性，如果你发现错误 只存在于债券，那该策略很可能是错的；</li>
<li>用 bagging 减少过拟合；在完成本书章节1-10 的研究之前别回测；</li>
<li>记录得到当前结果之前回测了多少次，从而推算出过拟合的可能性；</li>
<li>假如回测结果没能得到有效的策略，从头开始。千万不要在回测结果的基础上继续研究。 &gt; Backtesting while researching is like drinking and driving. &gt; Do not research under the influence of a backtest.</li>
</ul></li>
<li>如果用标准CV回测来选择策略，一些回测路径会重复出现，导致极易过拟合。所以一些随机性非常有必要，例如基于probability of backtest overfitting (PBO) 的回测。</li>
</ol>
<h2 id="chapter-12-使用交叉验证做回测">chapter 12 使用交叉验证做回测</h2>
<p>本章将介绍三种回测方法:向前游走;交叉验证，希望能得到更准确的回测结果。</p>
<ol type="1">
<li><p>向前游走即在回测时，使用历史数据来检验策略的样本外表现，历史数据有两种用法：</p>
<ol type="1">
<li><p>狭义上，模拟策略的历史表现（walk-forward，WF）；</p></li>
<li><p>广义上，模拟策略在特定市场环境（历史上不一定发生过）中的表现。</p>
<p>前一种方式更广为人知，但两种方式各有利弊，都应掌握。</p></li>
</ol></li>
<li><p>向前游走的优点：</p>
<ol type="1">
<li>有清晰的历史意义，与模拟盘的结果一致；</li>
<li>测试集在训练集之后，只要正确 purging 后就不存在信息泄露（见第七章）。</li>
</ol></li>
<li><p>向前游走的缺点：</p>
<ol type="1">
<li>只有一种情景测试（即历史重演），容易过拟合；</li>
<li>不足以代表未来的表现，因为回测结果可能受到特定数据的影响而产生偏差；</li>
<li>回测时数据利用率不高（“most of the information is used by only a small portion of the decisions”）</li>
</ol></li>
<li><p>交叉验证（cross-validation）得到一个新策略时，投资者往往想知道这个策略在“非常时期”，如08年金融危机、15年股灾中表现如何。可以将我们希望测试的时期划为测试集，其他时期划为训练集，例如将 2008年作为测试集，2009至今作为训练集。训练集在测试集之后的划分从历史角度来看并不准确（not historically accurate），但通过 CV回测的目的对策略做情景测试（scenarios），从而推断策略在未来的表现。</p></li>
</ol>
<blockquote>
<p>For each period of the backtest, we simulate the performance of a classifier that knew everything except for that period.</p>
</blockquote>
<ol start="5" type="1">
<li>交叉验证的缺点：
<ol type="1">
<li>只有一条回测路径（尽管不是历史路径）；</li>
<li>没有明确的历史意义；</li>
<li>由于测试集可能位于训练集之前，容易发生信息泄露。</li>
</ol></li>
<li>混合purged交叉验证 (CPCV)克服了向前游走和交叉验证的缺点。假定将全数据集分为 N 份，其中 k 份作为测试集，其余作为训练集，则共有<span class="math inline">\(C_N^k\)</span>种划分方案。所有回测路径数 （如下图所示） <img src="./img_2.png" alt="img_2.png" /></li>
<li>Assignment of testing groups to each of the 5 paths，按照划分依次在训练集上训练、测试集上测试，最后可以计算<span class="math inline">\(\varphi[N, k]\)</span>条路径分别的技术指标（如夏普率），从而更全面地考察模型表现。向前游走和交叉验证，混合purged交叉验证得到的结果（如夏普率）方差小，从而能减少过拟合的可能。</li>
</ol>
<h2 id="chapter-13-在合成数据上做回测">chapter 13 在合成数据上做回测</h2>
<p>本章以 OU 过程为例，说明了如何合成数据并进行回测，也可以尝试其它建模方式。</p>
<ol type="1">
<li><p>使用历史数据生成一个合成数据：先从从真实数据估计得到的分布，然后从分布中采样得到合成数据。</p></li>
<li><p>使用合成数据去做回测的好处是，可以测试很多次，在unseen的情况下，减少过拟合概率。</p></li>
<li><p>交易策略假定市场不是有效的，它们用基本面 / 技术面分析试图找到套利机会。</p></li>
<li><p>交易策略千变万化，但交易规则大同小异：比如策略的信号强于阈值则买入，达到盈利或止损点则卖出，这里的阈值、盈利止损点就是交易规则。如果用合成数据回测来确定交易规则，则过拟合的风险将大大减小。</p></li>
<li><p>用离散OU过程（discrete O-U process）对资产价格建模，给定资产i当前价格和未来预测价格，其在 t 次交易后的盈亏<span class="math inline">\(\pi_{i,t}\)</span>服从正态分布。可以此为依据模拟价格走势进行实验，得到最佳交易规则，而无需用真实历史数据回测。</p>
<blockquote>
<p>OU过程有下面的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/隨機微分方程">随机微分方程</a></p>
<p><span class="math display">\[{\displaystyle dx_{t}=-\theta \,x_{t}\,dt+\sigma \,dW_{t}}\]</span></p>
</blockquote></li>
<li><p>总而言之，通过探究导致价格波动的随机过程，而不是在真实历史数据上回测，尽管这样得到的交易规则可能不是最优的，但也远好于过拟合的结果。</p></li>
</ol>
<h2 id="chapter-14-回测统计">chapter 14 回测统计</h2>
<ol type="1">
<li><p>回测的三种范式：</p>
<ul>
<li>历史模拟，向前游走</li>
<li>情景模拟：交叉验证</li>
<li>在合成数据上做simulation</li>
</ul></li>
<li><p>回测统计量（Backtest statistics）应该帮助揭露策略的弊端（如可能的风险）、帮助投资者比较不同策略。</p></li>
<li><p>一般统计量（general characteristics）能告诉我们回测的大致特性：时间范围（回测起讫时间）、资产规模（Average AUM） ，策略的资金容量（Capacity）、杠杆率（Leverage）、平均持仓时间（Average holding period）、换手率（Annualized turnover），Maximum dollar position size/Ratio of longs/Frequency of bets</p></li>
<li><p>衡量策略表现（performance）的统计量包括：盈亏（PnL, Profit and Loss）、多头盈亏（PnL from long positions）、年化回报率（Annualized rate of return）、命中率（hit ratio）、命中回报率（Average return from hits）、失误回报率（Average return from misses）……</p></li>
<li><p>策略的回报率往往在一段时间内连续为正 / 负，称之为“周期”（Runs）。周期的存在增加了策略回撤的风险，所以需要一些统计量来衡量，包括：Returns Concentration（衡量回报的集中程度）、drawdown（回撤）、time under water。</p></li>
<li><p>某些策略错误地估计交易费用导致失败，这些需要考虑的统计量包括：Broker fees per turnover、Average slippage per turnover……</p></li>
<li><p>回测通常看以下指标：</p>
<ol type="1">
<li>绝对收益：净损失/收益（Net Profit/Loss），投资收益率</li>
<li>剔除通货膨胀的收益：风险调整之后的收益率（risk-adjusted return），市场敞口，波动性（最大回测）</li>
</ol></li>
<li><p>一些考虑到风险的统计量包括：夏普率（Sharpe Ratio，SR）、概率夏普比率（Probabilistic SR， PSR）、DSR（Deflated SR）、信息率（Information ratio）……</p>
<blockquote>
<p>夏普率衡量的是一项投资在对其调整风险后，相对于无风险资产的表现。</p>
<p>夏普率 = (投资收益 - 无风险收益)/投资标准差(or波动率）。</p>
<p>夏普率代表投资者额外承受的每一单位风险所获得的额外收益。</p>
</blockquote>
<figure>
<img src="./image-20210712151844519.png" alt="image-20210712151844519" /><figcaption aria-hidden="true">image-20210712151844519</figcaption>
</figure>
<ul>
<li>Usually, any <strong>Sharpe ratio</strong> greater than 1.0 is considered acceptable to good by investors.</li>
<li>A <strong>ratio</strong> higher than 2.0 is rated as very good.</li>
<li>A <strong>ratio</strong> of 3.0 or higher is considered excellent.</li>
<li>A <strong>ratio</strong> under 1.0 is considered sub-optimal. &gt; Every backtest result must be reported in conjunction with all the trials involved in its production. Absent that information, it is impossible to assess the backtest’s “false discovery“ probability. —— MARCOS’ THIRD LAW OF BACKTESTING</li>
</ul></li>
<li><p>基金经理往往希望对模型的收益进行归因（performance attribution），可以参考多因子模型（Barra’s multi-factor method）。</p></li>
</ol>
<h2 id="chapter-15-了解策略风险">chapter 15 了解策略风险</h2>
<ol type="1">
<li><p>所有策略都有盈利点和止损点，所以可以对策略的收益建模，检验策略对一些参数的敏感程度。</p></li>
<li><p>假定一个策略每年进行 n次 IID 决策，每一次有p的概率盈利<span class="math inline">\(\pi\)</span>，1-p的概率盈利<span class="math inline">\(-\pi\)</span>，则该策略的年化夏普比率为：</p>
<p><span class="math display">\[\theta[p, n]=\frac{2 p-1}{2 \sqrt{p(1-p)}} \sqrt{n}\]</span></p></li>
<li><p>低频交易：根据上面的公式，如果交易频率n不高，则需要较大的p才能达到高夏普比率。</p></li>
<li><p>高频交易:：即使p略大于 0.5，只要n足够大，夏普比率也可以很大，这是的思路。</p></li>
<li><p>策略风险（Strategy risk）和资产组合风险（portfolio risk）,假定<span class="math inline">\(p_{\theta}\)</span>为依照上面公式计算得到的盈亏平衡点</p>
<ol type="1">
<li>策略风险指<span class="math inline">\(P\left[p&lt;p_{\theta}\right]\)</span>,n很大时，p的小幅波动会带来夏普比率的很大改变。比如，p降低 1%可能就会抹去所有盈利。策略风险过大时，即使投资标的的风险不大，这个策略也有较大概率无法超过业绩标准。所以策略研发者需要想办法减小<span class="math inline">\(p_{\theta}\)</span>，比如调节 <span class="math inline">\(\left\{\pi_{+}, \pi_{-}, n\right\}\)</span></li>
<li>资产组合风险是市场中存在的风险，由首席风险官监控。。</li>
</ol></li>
</ol>
<h2 id="chapter-16-基于机器学习资产配置">chapter 16 基于机器学习资产配置</h2>
<p>本章提出了基于层次聚类的资产配置方法--层次风险平价方法（Hierarchical Risk Parity ，HRP），稳定性上优于传统的基于二次规划的CLA算法。</p>
<ol type="1">
<li><p>不稳定的传统投资组合方法：马科维茨提出了CLA算法（Critical Line Algorithm），用于求解不等式约束下的二次规划问题，尤其是资产组合优化问题。CLA 的缺点是鲁棒性不高，因为需要对资产间协方差矩阵取逆，资产组合中相关资产（多重共线性）越多，结果越不稳定，这便是 Markowitz’s curse。此外资产越多，用于估计协方差矩阵所需要的数据也越多。</p></li>
<li><p>层次风险平价方法（HRP）：一种层次聚类的算法，根据资产间相关性将所有资产建构成树状图。</p>
<blockquote>
<p>当我们决定投资摩根大通时，更可能考虑增/减持高盛的股票而不是一家地产公司的股票，因为摩根和高盛同属金融企业。<img src="./image-20210719114039467.png" alt="image-20210719114039467" /></p>
<figure>
<img src="./image-20210719114115246.png" alt="image-20210719114115246" /><figcaption aria-hidden="true">image-20210719114115246</figcaption>
</figure>
</blockquote></li>
<li><p>实验中 HRP 构建的投资组合比 CLA 更分散，风险也更低，同时HRP 不需要计算逆矩阵，更稳定。</p></li>
<li><p>HRP 不仅可以用于在不同资产上配置资金，还可用于在不同策略上配置资金。</p></li>
</ol>
<h2 id="参考">参考</h2>
<ol type="1">
<li>《Advances in Financial Machine Learning》</li>
<li>https://blog.csdn.net/weixin_38753422/article/details/100179559</li>
<li>https://zhuanlan.zhihu.com/p/29208399</li>
<li>https://zhuanlan.zhihu.com/p/109934805</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/99/">99</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chiechie</p>
  <div class="site-description" itemprop="description">a reader & thinker</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">197</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">210</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/chiechie" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;chiechie" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:328499034@qq.com" title="E-Mail → mailto:328499034@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/chiechie" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;chiechie" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chiechie</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
